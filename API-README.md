# API Ø§Ù„Ø¨ÙŠØª Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠ ğŸ‡¸ğŸ‡©

API Ø´Ø§Ù…Ù„ ÙŠØ®Ø¯Ù… Ù…Ù†ØµØ© Ø§Ù„Ø¨ÙŠØª Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠ Ù„Ù„ÙˆÙŠØ¨ ÙˆØ§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¬ÙˆØ§Ù„ØŒ ÙŠÙˆÙØ± Ø®Ø¯Ù…Ø§Øª Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„Ù„Ø´Ø±ÙƒØ§ØªØŒ Ø§Ù„Ù…Ù†ØªØ¬Ø§ØªØŒ Ø§Ù„ÙˆØ¸Ø§Ø¦ÙØŒ ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠØ©.

## ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª

- [Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ø±ÙŠØ¹](#Ø§Ù„Ø¨Ø¯Ø¡-Ø§Ù„Ø³Ø±ÙŠØ¹)
- [Ø§Ù„ØªØ«Ø¨ÙŠØª ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯](#Ø§Ù„ØªØ«Ø¨ÙŠØª-ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯)
- [Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©](#Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©)
- [Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªÙˆÙØ±Ø©](#Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª-Ø§Ù„Ù…ØªÙˆÙØ±Ø©)
- [Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…](#Ø£Ù…Ø«Ù„Ø©-Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…)
- [Ø±Ø¨Ø· Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¬ÙˆØ§Ù„](#Ø±Ø¨Ø·-Ø§Ù„ØªØ·Ø¨ÙŠÙ‚-Ø§Ù„Ø¬ÙˆØ§Ù„)
- [Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡](#Ù…Ø¹Ø§Ù„Ø¬Ø©-Ø§Ù„Ø£Ø®Ø·Ø§Ø¡)
- [Ù†Ø´Ø± API](#Ù†Ø´Ø±-api)

## ğŸš€ Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ø±ÙŠØ¹

### Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

- Node.js 18+
- npm Ø£Ùˆ yarn
- Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª (MongoDB Ø£Ùˆ PostgreSQL) - Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù„Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©

### ØªØ´ØºÙŠÙ„ Ø³Ø±ÙŠØ¹

```bash
# Ø§Ø³ØªÙ†Ø³Ø§Ø® Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
git clone https://github.com/your-repo/bayt-al-sudani.git
cd bayt-al-sudani

# ØªØ«Ø¨ÙŠØª Ø§Ù„Ø­Ø²Ù…
npm install

# Ø¥Ø¹Ø¯Ø§Ø¯ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©
cp .env.example .env

# ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù…
npm run dev:api
```

Ø§Ù„Ù€ API Ø³ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰: `http://localhost:3001`

## âš™ï¸ Ø§Ù„ØªØ«Ø¨ÙŠØª ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯

### 1. ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©

```bash
# Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
npm install express cors dotenv

# Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„Ø£Ù…Ø§Ù†
npm install jsonwebtoken bcrypt helmet

# Ù…ÙƒØªØ¨Ø§Øª Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
npm install mongoose # Ù„Ù„Ù€ MongoDB
# Ø£Ùˆ
npm install pg sequelize # Ù„Ù„Ù€ PostgreSQL

# Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„ØªØ·ÙˆÙŠØ±
npm install -D nodemon ts-node typescript @types/node @types/express
```

### 2. Ø¥Ø¹Ø¯Ø§Ø¯ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©

Ø£Ù†Ø´Ø¦ Ù…Ù„Ù `.env` ÙÙŠ Ø§Ù„Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø¬Ø°Ø±:

```env
# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø®Ø§Ø¯Ù…
PORT=3001
NODE_ENV=development

# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
JWT_SECRET=your-super-secret-jwt-key-here
JWT_EXPIRES_IN=7d
JWT_MOBILE_EXPIRES_IN=30d

# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
DATABASE_URL=mongodb://localhost:27017/bayt-sudani
# Ø£Ùˆ
DATABASE_URL=postgresql://username:password@localhost:5432/bayt_sudani

# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª CORS
WEB_URL=http://localhost:5173
MOBILE_SCHEME=sudanapp://

# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ù„ÙØ§Øª
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=10MB

# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
FCM_SERVER_KEY=your-fcm-server-key
APPLE_PUSH_KEY=your-apple-push-key
```

### 3. Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹

```
server/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ index.ts              # Ù†Ù‚Ø·Ø© Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù€ API
â”‚   â”œâ”€â”€ middleware/           # Middleware Ù…Ø®ØµØµ
â”‚   â”‚   â”œâ”€â”€ auth.ts          # Ù…ØµØ§Ø¯Ù‚Ø© JWT
â”‚   â”‚   â”œâ”€â”€ cors.ts          # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª CORS
â”‚   â”‚   â””â”€â”€ validation.ts    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
â”‚   â””â”€â”€ routes/              # Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù€ API
â”‚       â”œâ”€â”€ auth.ts          # Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
â”‚       â”œâ”€â”€ companies.ts     # Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´Ø±ÙƒØ§Øª
â”‚       â”œâ”€â”€ products.ts      # Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
â”‚       â”œâ”€â”€ jobs.ts          # Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆØ¸Ø§Ø¦Ù
â”‚       â”œâ”€â”€ stores.ts        # Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªØ§Ø¬Ø±
â”‚       â”œâ”€â”€ services.ts      # Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª
â”‚       â”œâ”€â”€ users.ts         # Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
â”‚       â”œâ”€â”€ mobile.ts        # Ø®Ø¯Ù…Ø§Øª Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø¬ÙˆØ§Ù„
â”‚       â””â”€â”€ upload.ts        # Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª
â”œâ”€â”€ models/                  # Ù†Ù…Ø§Ø°Ø¬ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
â”œâ”€â”€ utils/                   # Ø£Ø¯ÙˆØ§Øª Ù…Ø³Ø§Ø¹Ø¯Ø©
â””â”€â”€ package.json
```

### 4. Ø¥Ø¹Ø¯Ø§Ø¯ Scripts ÙÙŠ package.json

```json
{
  "scripts": {
    "dev:api": "nodemon server/api/index.ts",
    "build:api": "tsc -p server/tsconfig.json",
    "start:api": "node dist/server/api/index.js",
    "test:api": "jest server/",
    "deploy:api": "npm run build:api && pm2 start dist/server/api/index.js"
  }
}
```

## ğŸ” Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©

Ø§Ù„Ù€ API ÙŠØ³ØªØ®Ø¯Ù… JWT (JSON Web Tokens) Ù„Ù„Ù…ØµØ§Ø¯Ù‚Ø©.

### ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„

```bash
POST /api/auth/login
Content-Type: application/json
X-Platform: web # Ø£Ùˆ mobile

{
  "username": "admin",
  "password": "admin",
  "platform": "web"
}
```

**Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©:**

```json
{
  "user": {
    "id": "admin-001",
    "username": "admin",
    "email": "admin@baytsudani.com",
    "role": "super_admin",
    "profile": {
      "name": "Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚",
      "language": "ar"
    }
  },
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "platform": "web",
  "expiresIn": "7d"
}
```

### Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ù…Ù…ÙŠØ²

```bash
# Ø£Ø¶Ù Ø§Ù„Ø±Ù…Ø² ÙÙŠ header Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø­Ù…ÙŠØ©
Authorization: Bearer your-jwt-token-here
X-Platform: web # Ø£Ùˆ mobile
```

### ØªØ³Ø¬ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯

```bash
POST /api/auth/register
Content-Type: application/json

{
  "fullName": "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",
  "email": "ahmed@example.com",
  "phone": "+966501234567",
  "password": "password123",
  "accountType": "customer", # Ø£Ùˆ "merchant"
  "platform": "web"
}
```

## ğŸ›£ï¸ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªÙˆÙØ±Ø©

### Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© (`/api/auth`)

| Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© | Ø§Ù„Ù…Ø³Ø§Ø±      | Ø§Ù„ÙˆØµÙ                  |
| ------- | ----------- | ---------------------- |
| `POST`  | `/login`    | ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„           |
| `POST`  | `/register` | ØªØ³Ø¬ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯      |
| `GET`   | `/me`       | Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ |
| `POST`  | `/refresh`  | ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ù…Ù…ÙŠØ²     |
| `POST`  | `/logout`   | ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬           |

### Ø§Ù„Ø´Ø±ÙƒØ§Øª (`/api/companies`)

| Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©  | Ø§Ù„Ù…Ø³Ø§Ø± | Ø§Ù„ÙˆØµÙ              |
| -------- | ------ | ------------------ |
| `GET`    | `/`    | Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´Ø±ÙƒØ§Øª      |
| `GET`    | `/:id` | ØªÙØ§ØµÙŠÙ„ Ø´Ø±ÙƒØ©        |
| `POST`   | `/`    | Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©\* |
| `PUT`    | `/:id` | ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙƒØ©\*       |
| `DELETE` | `/:id` | Ø­Ø°Ù Ø´Ø±ÙƒØ©\*         |

### Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (`/api/products`)

| Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©  | Ø§Ù„Ù…Ø³Ø§Ø± | Ø§Ù„ÙˆØµÙ             |
| -------- | ------ | ----------------- |
| `GET`    | `/`    | Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª    |
| `GET`    | `/:id` | ØªÙØ§ØµÙŠÙ„ Ù…Ù†ØªØ¬       |
| `POST`   | `/`    | Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯\* |
| `PUT`    | `/:id` | ØªØ­Ø¯ÙŠØ« Ù…Ù†ØªØ¬\*      |
| `DELETE` | `/:id` | Ø­Ø°Ù Ù…Ù†ØªØ¬\*        |

### Ø§Ù„ÙˆØ¸Ø§Ø¦Ù (`/api/jobs`)

| Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©  | Ø§Ù„Ù…Ø³Ø§Ø± | Ø§Ù„ÙˆØµÙ               |
| -------- | ------ | ------------------- |
| `GET`    | `/`    | Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙˆØ¸Ø§Ø¦Ù       |
| `GET`    | `/:id` | ØªÙØ§ØµÙŠÙ„ ÙˆØ¸ÙŠÙØ©        |
| `POST`   | `/`    | Ø¥Ø¶Ø§ÙØ© ÙˆØ¸ÙŠÙØ© Ø¬Ø¯ÙŠØ¯Ø©\* |
| `PUT`    | `/:id` | ØªØ­Ø¯ÙŠØ« ÙˆØ¸ÙŠÙØ©\*       |
| `DELETE` | `/:id` | Ø­Ø°Ù ÙˆØ¸ÙŠÙØ©\*         |

### Ø§Ù„Ù…ØªØ§Ø¬Ø± (`/api/stores`)

| Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© | Ø§Ù„Ù…Ø³Ø§Ø± | Ø§Ù„ÙˆØµÙ             |
| ------- | ------ | ----------------- |
| `GET`   | `/`    | Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªØ§Ø¬Ø±     |
| `GET`   | `/:id` | ØªÙØ§ØµÙŠÙ„ Ù…ØªØ¬Ø±       |
| `POST`  | `/`    | Ø¥Ø¶Ø§ÙØ© Ù…ØªØ¬Ø± Ø¬Ø¯ÙŠØ¯\* |
| `PUT`   | `/:id` | ØªØ­Ø¯ÙŠØ« Ù…ØªØ¬Ø±\*      |

### Ø§Ù„Ø®Ø¯Ù…Ø§Øª (`/api/services`)

| Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© | Ø§Ù„Ù…Ø³Ø§Ø± | Ø§Ù„ÙˆØµÙ              |
| ------- | ------ | ------------------ |
| `GET`   | `/`    | Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª      |
| `GET`   | `/:id` | ØªÙØ§ØµÙŠÙ„ Ø®Ø¯Ù…Ø©        |
| `POST`  | `/`    | Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©\* |

### Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¬ÙˆØ§Ù„ (`/api/mobile`)

| Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© | Ø§Ù„Ù…Ø³Ø§Ø±            | Ø§Ù„ÙˆØµÙ           |
| ------- | ----------------- | --------------- |
| `GET`   | `/config`         | Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ |
| `POST`  | `/sync`           | Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª |
| `POST`  | `/register-token` | ØªØ³Ø¬ÙŠÙ„ Ø±Ù…Ø² FCM   |

**Ù…Ù„Ø§Ø­Ø¸Ø©:** \* ØªØªØ·Ù„Ø¨ Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØµÙ„Ø§Ø­ÙŠØ§Øª

## ğŸ“š Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

### Ù…Ø«Ø§Ù„ Ø´Ø§Ù…Ù„ - JavaScript/TypeScript

```typescript
// Ø¥Ø¹Ø¯Ø§Ø¯ Ø®Ø¯Ù…Ø© API
class BaytSudaniAPI {
  private baseURL = "http://localhost:3001/api";
  private token: string | null = null;

  // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ù…Ù…ÙŠØ²
  setToken(token: string) {
    this.token = token;
  }

  // Ø·Ù„Ø¨ Ø¹Ø§Ù…
  private async request(endpoint: string, options: RequestInit = {}) {
    const url = `${this.baseURL}${endpoint}`;
    const headers: HeadersInit = {
      "Content-Type": "application/json",
      "X-Platform": "web",
      ...options.headers,
    };

    if (this.token) {
      headers["Authorization"] = `Bearer ${this.token}`;
    }

    const response = await fetch(url, {
      ...options,
      headers,
    });

    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }

    return response.json();
  }

  // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
  async login(username: string, password: string) {
    const response = await this.request("/auth/login", {
      method: "POST",
      body: JSON.stringify({ username, password, platform: "web" }),
    });

    this.setToken(response.token);
    return response;
  }

  // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙƒØ§Øª
  async getCompanies(filters?: any) {
    const params = new URLSearchParams(filters);
    return this.request(`/companies?${params}`);
  }

  // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
  async getProducts(filters?: any) {
    const params = new URLSearchParams(filters);
    return this.request(`/products?${params}`);
  }

  // Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯
  async createProduct(productData: any) {
    return this.request("/products", {
      method: "POST",
      body: JSON.stringify(productData),
    });
  }
}

// Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
const api = new BaytSudaniAPI();

// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
await api.login("admin", "admin");

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙƒØ§Øª
const companies = await api.getCompanies({
  industry: "ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª",
  country: "Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©",
});

console.log("Ø§Ù„Ø´Ø±ÙƒØ§Øª:", companies);
```

### Ù…Ø«Ø§Ù„ React Hook

```typescript
// Hook Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ React
import { useState, useEffect } from 'react';

export const useAPI = () => {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const callAPI = async (apiCall: () => Promise<any>) => {
    try {
      setLoading(true);
      setError(null);
      const result = await apiCall();
      return result;
    } catch (err) {
      setError(err instanceof Error ? err.message : 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ');
      return null;
    } finally {
      setLoading(false);
    }
  };

  return { loading, error, callAPI };
};

// Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù€ Hook ÙÙŠ Ù…ÙƒÙˆÙ†
export const CompaniesPage = () => {
  const [companies, setCompanies] = useState([]);
  const { loading, error, callAPI } = useAPI();

  useEffect(() => {
    const loadCompanies = async () => {
      const result = await callAPI(() =>
        fetch('/api/companies').then(res => res.json())
      );
      if (result) {
        setCompanies(result);
      }
    };

    loadCompanies();
  }, []);

  if (loading) return <div>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>;
  if (error) return <div>Ø®Ø·Ø£: {error}</div>;

  return (
    <div>
      {companies.map(company => (
        <div key={company.id}>{company.name}</div>
      ))}
    </div>
  );
};
```

### Ù…Ø«Ø§Ù„ cURL

```bash
# ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
curl -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -H "X-Platform: web" \
  -d '{
    "username": "admin",
    "password": "admin",
    "platform": "web"
  }'

# Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙƒØ§Øª (Ù…Ø¹ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ù…Ù…ÙŠØ²)
curl -X GET "http://localhost:3001/api/companies?industry=ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "X-Platform: web"

# Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯
curl -X POST http://localhost:3001/api/products \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "X-Platform: web" \
  -d '{
    "name": "Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯",
    "description": "ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬",
    "price": 100,
    "storeId": "store-001",
    "category": "Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª"
  }'
```

## ğŸ“± Ø±Ø¨Ø· Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¬ÙˆØ§Ù„

### Ø¥Ø¹Ø¯Ø§Ø¯ React Native

```typescript
// services/ApiService.ts
import AsyncStorage from "@react-native-async-storage/async-storage";

export class MobileApiService {
  private static baseURL = "http://your-api-domain.com/api";

  // Ø­ÙØ¸ Ø§Ù„Ø±Ù…Ø² Ù…Ø­Ù„ÙŠØ§Ù‹
  static async setToken(token: string) {
    await AsyncStorage.setItem("auth_token", token);
  }

  // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø±Ù…Ø²
  static async getToken(): Promise<string | null> {
    return await AsyncStorage.getItem("auth_token");
  }

  // Ø·Ù„Ø¨ Ù…Ø¹ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
  static async authenticatedRequest(endpoint: string, options: any = {}) {
    const token = await this.getToken();

    return fetch(`${this.baseURL}${endpoint}`, {
      ...options,
      headers: {
        "Content-Type": "application/json",
        "X-Platform": "mobile",
        Authorization: token ? `Bearer ${token}` : "",
        ...options.headers,
      },
    });
  }

  // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø¬ÙˆØ§Ù„
  static async login(credentials: any) {
    const response = await fetch(`${this.baseURL}/auth/login`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "X-Platform": "mobile",
      },
      body: JSON.stringify({
        ...credentials,
        platform: "mobile",
      }),
    });

    const data = await response.json();

    if (data.token) {
      await this.setToken(data.token);
    }

    return data;
  }
}
```

### Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¬ÙˆØ§Ù„

```typescript
// services/SyncService.ts
export class SyncService {
  static async syncAllData() {
    try {
      // Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      const [companies, products, jobs] = await Promise.all([
        MobileApiService.authenticatedRequest("/companies"),
        MobileApiService.authenticatedRequest("/products"),
        MobileApiService.authenticatedRequest("/jobs"),
      ]);

      // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹
      await AsyncStorage.setItem("companies", JSON.stringify(companies));
      await AsyncStorage.setItem("products", JSON.stringify(products));
      await AsyncStorage.setItem("jobs", JSON.stringify(jobs));
      await AsyncStorage.setItem("last_sync", new Date().toISOString());

      return true;
    } catch (error) {
      console.error("Sync failed:", error);
      return false;
    }
  }

  // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ù…Ø­Ù„ÙŠØ§Ù‹
  static async loadCachedData() {
    const [companies, products, jobs] = await Promise.all([
      AsyncStorage.getItem("companies"),
      AsyncStorage.getItem("products"),
      AsyncStorage.getItem("jobs"),
    ]);

    return {
      companies: companies ? JSON.parse(companies) : [],
      products: products ? JSON.parse(products) : [],
      jobs: jobs ? JSON.parse(jobs) : [],
    };
  }
}
```

## âŒ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

### Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù…Ø¹ÙŠØ§Ø±ÙŠØ©

| Ø§Ù„ÙƒÙˆØ¯ | Ø§Ù„Ù…Ø¹Ù†Ù‰           | Ø§Ù„ÙˆØµÙ                     |
| ----- | ---------------- | ------------------------- |
| `200` | Ù†Ø¬Ø­              | ØªÙ… ØªÙ†ÙÙŠØ° Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­      |
| `201` | ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡        | ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙˆØ±Ø¯ Ø¨Ù†Ø¬Ø§Ø­     |
| `400` | Ø·Ù„Ø¨ Ø®Ø§Ø·Ø¦         | Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨ ØºÙŠØ± ØµØ­ÙŠØ­Ø©    |
| `401` | ØºÙŠØ± Ù…ØµØ±Ø­         | Ù…Ø·Ù„ÙˆØ¨ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„          |
| `403` | Ù…Ø­Ø¸ÙˆØ±            | Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙ„Ø§Ø­ÙŠØ© ÙƒØ§ÙÙŠØ©      |
| `404` | ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯        | Ø§Ù„Ù…ÙˆØ±Ø¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯          |
| `422` | Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ§Ù„Ø­Ø© | ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª |
| `500` | Ø®Ø·Ø£ Ø®Ø§Ø¯Ù…         | Ø®Ø·Ø£ Ø¯Ø§Ø®Ù„ÙŠ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…       |

### ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

```json
{
  "error": "Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©",
  "message": "ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ© Ø¹Ù† Ø§Ù„Ø®Ø·Ø£",
  "code": "ERROR_CODE",
  "details": {
    "field": "Ø§Ø³Ù… Ø§Ù„Ø­Ù‚Ù„ Ø§Ù„Ø°ÙŠ ÙÙŠÙ‡ Ø®Ø·Ø£",
    "value": "Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®Ø§Ø·Ø¦Ø©"
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯

```typescript
// Ù…Ø¹Ø§Ù„Ø¬ Ø£Ø®Ø·Ø§Ø¡ Ø´Ø§Ù…Ù„
const handleAPIError = (error: any) => {
  if (error.status === 401) {
    // Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    window.location.href = "/login";
  } else if (error.status === 403) {
    // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø¹Ø¯Ù… Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
    alert("Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ±Ø¯");
  } else if (error.status >= 500) {
    // Ø®Ø·Ø£ Ø®Ø§Ø¯Ù…
    alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹");
  } else {
    // Ø£Ø®Ø·Ø§Ø¡ Ø£Ø®Ø±Ù‰
    alert(error.message || "Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹");
  }
};
```

## ğŸš€ Ù†Ø´Ø± API

### Ù†Ø´Ø± Ø¹Ù„Ù‰ Vercel

```bash
# ØªØ«Ø¨ÙŠØª Vercel CLI
npm install -g vercel

# ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
vercel login

# Ù†Ø´Ø± Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
vercel

# ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
vercel env add JWT_SECRET
vercel env add DATABASE_URL
```

### Ø¥Ø¹Ø¯Ø§Ø¯ `vercel.json`

```json
{
  "version": 2,
  "builds": [
    {
      "src": "server/api/index.ts",
      "use": "@vercel/node"
    }
  ],
  "routes": [
    {
      "src": "/api/(.*)",
      "dest": "server/api/index.ts"
    }
  ],
  "env": {
    "NODE_ENV": "production"
  }
}
```

### Ù†Ø´Ø± Ø¹Ù„Ù‰ Railway

```bash
# ØªØ«Ø¨ÙŠØª Railway CLI
npm install -g @railway/cli

# ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
railway login

# Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø´Ø±ÙˆØ¹ Ø¬Ø¯ÙŠØ¯
railway init

# Ù†Ø´Ø±
railway up
```

### Ù†Ø´Ø± Ø¹Ù„Ù‰ Heroku

```bash
# ØªØ«Ø¨ÙŠØª Heroku CLI
npm install -g heroku

# ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
heroku login

# Ø¥Ù†Ø´Ø§Ø¡ ØªØ·Ø¨ÙŠÙ‚
heroku create bayt-sudani-api

# Ø¥Ø¶Ø§ÙØ© Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©
heroku config:set JWT_SECRET=your-secret
heroku config:set NODE_ENV=production

# Ù†Ø´Ø±
git push heroku main
```

### Ù†Ø´Ø± Ø¹Ù„Ù‰ Ø®Ø§Ø¯Ù… Ø´Ø®ØµÙŠ (VPS)

```bash
# ØªØ«Ø¨ÙŠØª PM2
npm install -g pm2

# Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
npm run build:api

# ØªØ´ØºÙŠÙ„ Ø¨Ù€ PM2
pm2 start dist/server/api/index.js --name "bayt-sudani-api"

# Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª PM2
pm2 save
pm2 startup
```

### Ø¥Ø¹Ø¯Ø§Ø¯ Nginx (Ù„Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø´Ø®ØµÙŠ)

```nginx
server {
    listen 80;
    server_name api.baytsudani.com;

    location / {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

## ğŸ“ Ø§Ø®ØªØ¨Ø§Ø± API

### ØªØ«Ø¨ÙŠØª Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±

```bash
npm install -D jest supertest @types/jest @types/supertest
```

### Ù…Ø«Ø§Ù„ Ø§Ø®ØªØ¨Ø§Ø±

```typescript
// tests/auth.test.ts
import request from "supertest";
import app from "../server/api/index";

describe("Auth API", () => {
  test("ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­", async () => {
    const response = await request(app).post("/api/auth/login").send({
      username: "admin",
      password: "admin",
      platform: "web",
    });

    expect(response.status).toBe(200);
    expect(response.body).toHaveProperty("token");
    expect(response.body.user.username).toBe("admin");
  });

  test("ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©", async () => {
    const response = await request(app).post("/api/auth/login").send({
      username: "admin",
      password: "wrong-password",
      platform: "web",
    });

    expect(response.status).toBe(401);
    expect(response.body).toHaveProperty("error");
  });
});
```

### ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª

```bash
npm test
```

## ğŸ¤ Ø§Ù„Ù…Ø³Ø§Ù‡Ù…Ø©

1. Fork Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
2. Ø¥Ù†Ø´Ø§Ø¡ ÙØ±Ø¹ Ù„Ù„Ù…ÙŠØ²Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (`git checkout -b feature/amazing-feature`)
3. Commit Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª (`git commit -m 'Add amazing feature'`)
4. Push Ù„Ù„ÙØ±Ø¹ (`git push origin feature/amazing-feature`)
5. ÙØªØ­ Pull Request

## ğŸ“„ Ø§Ù„ØªØ±Ø®ÙŠØµ

Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…Ø±Ø®Øµ ØªØ­Øª Ø±Ø®ØµØ© MIT - Ø§Ù†Ø¸Ø± Ù…Ù„Ù [LICENSE](LICENSE) Ù„Ù„ØªÙØ§ØµÙŠÙ„.

## ğŸ“ Ø§Ù„Ø¯Ø¹Ù…

Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©:

- Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: api-support@baytsudani.com
- GitHub Issues: [ÙØªØ­ issue Ø¬Ø¯ÙŠØ¯](https://github.com/your-repo/issues)
- Ø§Ù„ØªÙˆØ«ÙŠÙ‚: [docs.baytsudani.com](https://docs.baytsudani.com)

---

**ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ Ø¨Ù€ â¤ï¸ Ù„Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠ**
