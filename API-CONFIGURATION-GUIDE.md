# دليل إعدادات خوادم الـ API

تم تطوير نظام متكامل لإدارة خوادم API خارجية يسمح لمدير التطبيق بربط النظام بقواعد بيانات وخوادم مختلفة بسهولة.

## المميزات الرئيسية

### 1. إدارة متعددة الخوادم

- إضافة عدد غير محدود من خوادم API
- تفعيل/إلغاء تفعيل الخوادم
- تحديد خادم افتراضي
- التبديل السريع بين الخوادم

### 2. إعدادات متقدمة لكل خادم

- **رابط الخادم**: URL الأساسي للخادم
- **نقاط النهاية المخصصة**: تخصيص روابط مختلفة لكل خدمة
- **المصادقة**: دعم Bearer Token، API Key، أو Basic Auth
- **العناوين المخصصة**: إضافة headers إضافية
- **إعدادات الأداء**: timeout، عدد المحاولات
- **فحص الصحة**: اختبار دوري للاتصال

### 3. واجهة مستخدم سهلة

- لوحة تحكم في إعدادات المدير
- مؤشر حالة الاتصال في الوقت الفعلي
- اختبار فوري للاتصال
- تصدير/استيراد الإعدادات

## طريقة الاستخدام

### الوصول لإعدادات الخوادم

1. سجل دخول كمدير للتطبيق
2. اذهب إلى **الإعدادات** من لوحة التحكم
3. اختر تبويبة **الخوادم**

### إضافة خادم جديد

1. اضغط على **"إضافة خادم جديد"**
2. املأ البيانات المطلوبة:
   - **اسم الخادم**: اسم وصفي للخادم
   - **رابط الخادم**: مثل `https://api.example.com`
   - **الوصف**: وصف اختياري للخادم
   - **نشط**: فعّل لجعل الخادم قابل للاستخدام
   - **افتراضي**: اجعله الخادم الافتراضي

### إعدادات نقاط النهاية

يمكن تخصيص روابط مختلفة لكل خدمة:

- `/auth` - للمصادقة
- `/users` - لإدارة المستخدمين
- `/stores` - للمتاجر
- `/products` - للمنتجات
- `/companies` - للشركات
- `/jobs` - للوظائف
- `/orders` - للطلبات
- `/analytics` - للتحليلات

### إعدادات المصادقة

#### Bearer Token

- النوع الأكثر شيوعاً
- يستخدم token المستخدم الحالي
- مناسب لمعظم APIs الحديثة

#### API Key

- مفتاح ثابت للوصول للAPI
- يتم إرساله في header مخصص
- مناسب للخوادم التي تتطلب مفاتيح ثابتة

#### Basic Authentication

- مصادقة أساسية (قيد التطوير)

### اختبار الاتصال

- اضغط **"اختبار"** بجانب أي خادم
- سيظهر نتيجة الاختبار ووقت الاستجابة
- يمكن أيضاً اختبار الخادم النشط من مؤشر الحالة

### تفعيل خادم

1. اضغط **"تفعيل"** بجانب الخادم المطلوب
2. سيصبح هذا الخادم هو المستخدم لجميع طلبات API
3. سيظهر مؤشر الحالة التغيير فوراً

## مؤشر حالة الاتصال

### الألوان والمعاني

- **أخضر**: متصل بنجاح
- **أحمر**: فشل الاتصال
- **رمادي**: لم يتم الفحص بعد
- **أزرق**: جاري الفحص

### معلومات المؤشر

- نوع الخادم (محلي/خارجي)
- اسم الخادم النشط
- وقت الاستجابة
- آخر فحص للاتصال

## إدارة الإعدادات

### تصدير الإعدادات

- اضغط **"تصدير الإعدادات"**
- سيتم تنزيل ملف JSON يحتوي على جميع إعدادات الخوادم
- احتفظ بنسخة احتياطية من هذا الملف

### استيراد الإعدادات

- اضغط **"استيراد الإعدادات"**
- اختر ملف JSON المُصدَّر مسبقاً
- سيتم إضافة الخوادم الجديدة للقائمة الحالية

### إعادة تعيين

- **"إعادة تعيين"**: يحذف جميع الخوادم ويعيد الافتراضية
- استخدم بحذر - ستفقد جميع الإعدادات المخصصة

## نصائح مهمة

### الأمان

- لا تشارك إعدادات تحتوي على API Keys
- استخدم HTTPS دائماً للخوادم الخارجية
- اختبر الخوادم قبل تفعيلها في الإنتاج

### الأداء

- اختر timeout مناسب (عادة 10-30 ثانية)
- اس��خدم خوادم قريبة جغرافياً لتقليل زمن الاستجابة
- راقب مؤشر الحالة لاكتشاف المشاكل سريعاً

### استكشاف الأخطاء

1. **فشل الاتصال**: تحقق من رابط الخادم والشبكة
2. **مصادقة فاشلة**: راجع إعدادات المصادقة والTokens
3. **استجابة بطيئة**: اضبط timeout أو استخدم خادم أسرع

## التطوير التقني

### للمطورين

- الإعدادات محفوظة في `localStorage`
- يمكن الوصول للـ API Manager من `apiConfigManager`
- الخدمة الرئيسية في `ApiService`
- مؤشر الحالة متاح كـ component منفصل

### الملفات المهمة

```
client/lib/apiConfig.ts          # مدير إعدادات API
client/lib/apiService.ts         # خدمة API المحدثة
client/hooks/use-api-config.tsx  # React hooks
client/components/ApiConnectionStatus.tsx # مؤشر الحالة
```

## الدعم

إذا واجهت أي مشاكل:

1. تحقق من مؤشر حالة الاتصال
2. اختبر الخادم من لوحة الإعدادات
3. راجع console المتصفح للأخطاء التفصيلية
4. تأكد من صحة إعدادات الخادم الخارجي

---

تم تطوير هذا النظام ليكون مرناً وسهل الاستخدام، مع إمكانية التوسع مستقبلاً لدعم المزيد من أنواع المصادقة والخصائص المتقدمة.
